# Auto-generated by Recipe Engine, do not modify manually.
# This job is generated by the wrench recipe engine module, see find the docs here: http://Go/ii2fb

# Pack Unity glTFast
package_pack_-_cloud_gltfast:
  name: Package Pack - cloud.gltfast
  agent:
    image: package-ci/ubuntu-20.04:default
    type: Unity::VM
    flavor: b1.large
  commands:
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: unity-config package add dependency com.unity.formats.gltf.validator@0.2.0-preview.1 --package-path Packages/com.unity.cloud.gltfast.tests
  - command: cp .yamato/ValidationExceptions.json* Packages/com.unity.cloud.gltfast
  - command: upm-ci package pack --package-path Packages/com.unity.cloud.gltfast.tests
  - command: cp upm-ci~/packages/packages.json upm-ci~/packages/com.unity.cloud.gltfast.tests_packages.json
  - command: rm upm-ci~/packages/packages.json
  - command: mkdir -p upm-ci~/temp/packages
  - command: mv upm-ci~/packages/* upm-ci~/temp/packages
  - command: upm-ci package pack --package-path Packages/com.unity.cloud.gltfast
  - command: cp upm-ci~/packages/packages.json upm-ci~/packages/com.unity.cloud.gltfast_packages.json
  - command: mv upm-ci~/temp/packages/* upm-ci~/packages
  - command: curl https://artifactory.prd.it.unity3d.com/artifactory/stevedore-unity-internal/wrench-localapv/1-2-60_641f75ebc79901fc7eb7880e924d4adc41d99ad42d02aa320814a9e1e75463c4.zip -o wrench-localapv.zip
  - command: 7z x -aoa wrench-localapv.zip
  - command: pip install semver requests --index-url https://artifactory-slo.bf.unity3d.com/artifactory/api/pypi/pypi/simple
  - command: python PythonScripts/PackageJsonCondersor.py
  after:
  - command: bash .yamato/generated-scripts/infrastructure-instability-detection-linux.sh
  artifacts:
    packages:
      paths:
      - upm-ci~/packages/**/*
  variables:
    UPMCI_ACK_LARGE_PACKAGE: 1
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 0.10.45.0

# Pack Unity glTFast Tests
package_pack_-_cloud_gltfast_tests:
  name: Package Pack - cloud.gltfast.tests
  agent:
    image: package-ci/ubuntu-20.04:default
    type: Unity::VM
    flavor: b1.large
  commands:
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: upm-ci package pack --package-path Packages/com.unity.cloud.gltfast.tests
  - command: cp upm-ci~/packages/packages.json upm-ci~/packages/com.unity.cloud.gltfast.tests_packages.json
  after:
  - command: bash .yamato/generated-scripts/infrastructure-instability-detection-linux.sh
  artifacts:
    packages:
      paths:
      - upm-ci~/packages/**/*
  variables:
    UPMCI_ACK_LARGE_PACKAGE: 1
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 0.10.45.0

